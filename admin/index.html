<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hoop.dev Documentation - Content Manager</title>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    window.CMS_MANUAL_INIT = true;
  </script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    .cms-preview {
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }

    .connection-preview {
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      background: white;
    }

    .connection-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .connection-icon {
      width: 32px;
      height: 32px;
      border-radius: 4px;
      background: #f8fafc;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .connection-name {
      font-size: 18px;
      font-weight: 600;
      margin: 0;
    }

    .connection-desc {
      color: #6b7280;
      font-size: 14px;
      margin: 4px 0;
    }

    .connection-badges {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }

    .badge {
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }

    .badge-databases {
      background: #dbeafe;
      color: #1e40af;
    }

    .badge-container-platforms {
      background: #f3e8ff;
      color: #7c3aed;
    }

    .badge-developer-consoles {
      background: #fef3c7;
      color: #92400e;
    }

    .badge-infrastructure-access {
      background: #ecfdf5;
      color: #059669;
    }

    .badge-network-services {
      background: #fef2f2;
      color: #dc2626;
    }

    .badge-new {
      background: #dcfce7;
      color: #166534;
    }

    .badge-stable {
      background: #f1f5f9;
      color: #475569;
    }

    .connection-section {
      margin-top: 12px;
      font-size: 12px;
      color: #6b7280;
    }

    .connection-code {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
      padding: 8px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 11px;
      margin-top: 8px;
      overflow-x: auto;
    }

    .tag-list {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
    }

    .tag {
      background: #f0f9ff;
      color: #0369a1;
      padding: 2px 6px;
      border-radius: 8px;
      font-size: 10px;
    }
  </style>
</head>

<body>
  <!-- Include Decap CMS -->
  <script src="https://cdn.jsdelivr.net/npm/decap-cms@^3.0.0/dist/decap-cms.js"></script>

  <script>
    const local_backend = window.location.hostname === 'localhost';

    CMS.init({
      config: {
        local_backend: local_backend,
        backend: {
          name: 'git-gateway',
          branch: 'main',
          publish_mode: 'editorial_workflow'
        },
        load_config_file: false,
        media_folder: 'images/uploads',
        public_folder: '/images/uploads',
        collections: [
          {
            name: 'connections',
            label: 'Connections',
            folder: 'store/connections',
            create: true,
            slug: '{{id}}',
            extension: 'yml',
            format: 'yaml',
            fields: [
              {
                label: 'ID',
                name: 'id',
                widget: 'string',
                hint: 'Unique identifier (e.g., mongodb, postgresql)'
              },
              { label: 'Name', name: 'name', widget: 'string' },
              { label: 'Description', name: 'description', widget: 'text' },
              {
                label: 'Category',
                name: 'category',
                widget: 'select',
                options: ['databases', 'cloud-services', 'applications', 'developer-consoles', 'development-environments', 'infrastructure-access', 'web-applications']
              },
              {
                label: 'Icon Name',
                name: 'icon-name',
                widget: 'string',
                hint: 'Icon name to be displayed'
              },
              {
                label: 'Tags',
                name: 'tags',
                widget: 'list',
                collapsed: false,
                field: { label: 'Tag', name: 'tag', widget: 'string' }
              },

              // Overview Section
              {
                label: 'Overview',
                name: 'overview',
                widget: 'object',
                collapsed: false,
                fields: [
                  {
                    label: 'Detailed Description',
                    name: 'description',
                    widget: 'text',
                    hint: 'Detailed description for the overview section'
                  }
                ]
              },

              // Setup Guide Section
              {
                label: 'Setup Guide',
                name: 'setupGuide',
                widget: 'object',
                collapsed: false,
                fields: [
                  {
                    label: 'Access Methods',
                    name: 'accessMethods',
                    widget: 'object',
                    fields: [
                      { label: 'Web App', name: 'webapp', widget: 'boolean', default: false },
                      { label: 'CLI', name: 'cli', widget: 'boolean', default: false },
                      { label: 'Runbooks', name: 'runbooks', widget: 'boolean', default: false }
                    ]
                  }
                ]
              },
              // Resource Configuration Section
              {
                label: 'Resource Configuration',
                name: 'resourceConfiguration',
                widget: 'object',
                collapsed: false,
                fields: [
                  {
                    label: 'Type',
                    name: 'type',
                    widget: 'select',
                    options: ['database', 'custom', 'application']
                  },
                  {
                    label: 'Subtype',
                    name: 'subtype',
                    widget: 'string',
                    hint: 'Specific technology identifier (e.g., postgres, mysql, aws-cli)'
                  },
                  {
                    label: 'Command',
                    name: 'command',
                    widget: 'list',
                    required: false,
                    collapsed: false,
                    field: { label: 'Command Part', name: 'part', widget: 'string' },
                    hint: 'Array of command parts for execution'
                  },
                  {
                    label: 'Credentials',
                    name: 'credentials',
                    widget: 'list',
                    required: false,
                    collapsed: false,
                    fields: [
                      {
                        label: 'Name',
                        name: 'name',
                        widget: 'string',
                        hint: 'Environment variable or credential name'
                      },
                      {
                        label: 'Type',
                        name: 'type',
                        widget: 'select',
                        options: ['env-var', 'filesystem'],
                        default: 'env-var'
                      },
                      {
                        label: 'Required',
                        name: 'required',
                        widget: 'boolean',
                        default: true
                      },
                      {
                        label: 'Description',
                        name: 'description',
                        widget: 'text',
                        hint: 'Description of what this credential is used for'
                      },
                      {
                        label: 'Placeholder',
                        name: 'placeholder',
                        widget: 'string',
                        required: false,
                        hint: 'Optional placeholder text for input fields'
                      },
                    ]
                  }
                ]
              },

              // Features Section
              {
                label: 'Features',
                name: 'features',
                widget: 'object',
                collapsed: true,
                fields: [
                  {
                    label: 'TLS Termination Proxy',
                    name: 'tlsTerminationProxy',
                    widget: 'object',
                    fields: [
                      { label: 'Native', name: 'native', widget: 'boolean', default: false },
                      { label: 'One Off', name: 'oneOff', widget: 'boolean', default: true },
                      { label: 'Note', name: 'note', widget: 'string', required: false }
                    ]
                  },
                  {
                    label: 'Audit',
                    name: 'audit',
                    widget: 'object',
                    fields: [
                      { label: 'Native', name: 'native', widget: 'boolean', default: false },
                      { label: 'One Off', name: 'oneOff', widget: 'boolean', default: true }
                    ]
                  },
                  {
                    label: 'Data Masking Google DLP',
                    name: 'dataMaskingGoogleDLP',
                    widget: 'object',
                    fields: [
                      { label: 'Native', name: 'native', widget: 'boolean', default: false },
                      { label: 'One Off', name: 'oneOff', widget: 'boolean', default: true }
                    ]
                  },
                  {
                    label: 'Data Masking MS Presidio',
                    name: 'dataMaskingMSPresidio',
                    widget: 'object',
                    fields: [
                      { label: 'Native', name: 'native', widget: 'boolean', default: false },
                      { label: 'One Off', name: 'oneOff', widget: 'boolean', default: true }
                    ]
                  },
                  {
                    label: 'Credentials Offload',
                    name: 'credentialsOffload',
                    widget: 'object',
                    fields: [
                      { label: 'Native', name: 'native', widget: 'boolean', default: false },
                      { label: 'One Off', name: 'oneOff', widget: 'boolean', default: true }
                    ]
                  },
                  {
                    label: 'Interactive Access',
                    name: 'interactiveAccess',
                    widget: 'object',
                    fields: [
                      { label: 'Native', name: 'native', widget: 'boolean', default: false },
                      { label: 'One Off', name: 'oneOff', widget: 'boolean', default: true }
                    ]
                  }
                ]
              },

              // Documentation Configuration
              {
                label: 'Documentation Configuration',
                name: 'documentationConfig',
                widget: 'object',
                collapsed: true,
                fields: [
                  {
                    label: 'Path',
                    name: 'path',
                    widget: 'string',
                    hint: 'Path to the documentation file (e.g., quickstart/databases/postgres)'
                  }
                ]
              },

              {
                label: 'Additional Information',
                name: 'additionalInformation',
                widget: 'markdown',
                required: false
              }
            ]
          }
        ]
      }
    });

    // Netlify Identity setup - comentado para desenvolvimento local
    if (window.netlifyIdentity && !local_backend) {
      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });

      window.netlifyIdentity.on("signup", user => {
        console.log("User signed up:", user);
        document.location.href = "/admin/";
      });

      window.netlifyIdentity.on("confirm", user => {
        console.log("User confirmed:", user);
        document.location.href = "/admin/";
      });

      window.netlifyIdentity.on("invite", user => {
        console.log("User accepted invite:", user);
        document.location.href = "/admin/";
      });
    }
  </script>

</body>

</html>
