---
title: "Command Line"
description: "Install and configure the hoop.dev CLI to interact with your applications."
---

import Prerequisites from '/snippets/GettingStartedPrerequisites.mdx';

<Prerequisites />

## Installation

<Tabs>
  <Tab title="MacOS">
    Through homebrew:
    ```bash
      brew tap hoophq/brew https://github.com/hoophq/brew
      brew install hoop
    ```

    To upgrade it:

    ```bash
      brew upgrade hoop
    ```
  </Tab>
  <Tab title="Linux">
    To install or upgrade:
    ```bash
      curl -s -L https://releases.hoop.dev/release/install-cli.sh | sh
    ```
  </Tab>
  <Tab title="Windows">
    <Steps>
      <Step title="Download">
        Download the latest release of [hoop command line](https://github.com/hoophq/hoop/releases) for your architecture (usually **hoop-windows-amd64**) and save it in the **Downloads** folder
      </Step>
      <Step title="Extract">
        Extract the file using **winrar** or **winzip**
      </Step>
      <Step title="Place it in the right folder">
        Move the extracted file `hoop.exe` to the folder `C:\Windows\System32\`
      </Step>
      <Step title="Check the installation">
        Open a terminal session and type `hoop version` if it successfully shows the program’s version it’s installed.
      </Step>
    </Steps>
  </Tab>
  <Tab title="Windows WSL">
    ### Prerequisites
    1. Install the Windows Terminal https://aka.ms/terminal
    2. Install Ubuntu WSL https://ubuntu.com/wsl
    3. Open the Windows Terminal App
    4. Install and open the Ubuntu typing `ubuntu`. It should prompt to create a user in the first time
    ```bash
      PS C:\Users\san> ubuntu
      san@DESKTOP-BBQAAEG:~$
    ```
    5. gain root access
    ```bash
      sudo su -
    ```
    6. To install or upgrade the hoop.dev command line:
    ```bash
      curl -s -L https://releases.hoop.dev/release/install-cli.sh | sh
    ```
  </Tab>
  <Tab title="Manual">
    Check the latest version for your operating system architecture in the [releases page](https://github.com/hoophq/hoop/releases).
  </Tab>
</Tabs>

## Authentication

The authentication process requires an **access token** or an **API Key** to interact with the gateway.
Below, there are sections outlining the scenarios that could be used when interacting with the command line.

<Note>
  The authentication process requires knowning the gateway instance URL where the Hoop gateway is running.
  Our managed instances are hosted under the URL:

  ```
  https://use.hoop.dev
  ```

  Contact your administrator if you have a self hosted installation and don't know this information.
</Note>

### Connection Usage Scenario

This scenario is recommended when users need to interact with connections to perform daily basis operations under the resources in which they have access to.

The user will perform the login to obtain a valid access token based on the expiration policy time of your identity provider.

<Tabs>
  <Tab title="Self Hosted">
    This command is executed only once per machine.
    It creates or wipes the file `$HOME/.hoop/config.toml` in your local machine

    ```sh
    hoop config create --api-url https://yourgateway-domain.tld
    ```

    This command is executed every time the token expires or the command above is executed.

    ```sh
    hoop login
    ```
  </Tab>
  <Tab title="Managed Instance">
    If this is your first time running the command line, it will setup the file `$HOME/.hoop/config.toml` and prompt to configure the default gateway URL.
    The browser of the user will open and redirect him to our identity provider.
    Further calls will just open the browser and update the `token` from the configuration file.

    After finishing this process, the `config.toml` will have an access token valid for **24 hours**.

    ```sh
    hoop login
    ```

    ```
    Press enter to leave the defaults
    API_URL [https://use.hoop.dev]:
    ```
  </Tab>
</Tabs>


### Automation Usage Scenario

This scenario is recommend for administrators that want programmatic access to the API,
such as managing connections, policies or performing an ad-hoc executions under a automation pipeline.

The requirements for such cases requires a static authentication that could be obtained via programmatic access.
There are two ways to obtain a token to authenticate API clients.

#### Static API Key

Using a static API Key is one of the methods that consists in setting up an environment variable in the gateway with a random string.

Configure the token in your local configuration by issuing the command below:

```sh
HOOP_TOKEN=<api-key> hoop config create --api-url https://yourgateway-domain.tld
```

- Refer for the [API Key Usage for more information](/setup/apis/api-key)

#### Service Account

The service account allow access if your identity provider support the [Oauth2 Client Credentials Grant type](https://oauth.net/2/grant-types/client-credentials/).

```sh
export HOOP_TOKEN="$(/tmp/issue-client-credentials-token-from-idp.sh)"
hoop config create --api-url https://yourgateway-domain.tld
```

<Note>
  The access token obtained from your identity provider usually expires.
  To obtain a fresh access token, create a script that issues a valid access token.
</Note>

- Refer to the [Service Account Usage guide for more information](/setup/apis/service-accounts).

### Using Environment Variables

Another way to use the command line is by exporting the following environment variables:

```sh
export HOOP_APIURL=https://use.hoop.dev
export HOOP_GRPCURL=grpcs://use.hoop.dev:8443
export HOOP_TOKEN=<your-access-token-or-api-key>
export HOOP_TLSCA=file:///path/to/ca.pem
# test it
hoop admin get userinfo
```

When using environment variables, it will ignore the local configuration file `$HOME/.hoop/config.yaml`

## Managing Configuration

- Configure your Gateway URL and clear any existent configuration

```sh
hoop config create --api-url https://yourgateway-domain.tld
```

- Configure the Gateway URL and the gRPC URL

```sh
hoop config create
  --api-url https://yourgateway-domain.tld \
  --grpc-url grpcs://yourgateway-domain.tld:443
```

<Note>
  This flag is optional and used only to interact with connections.
  The `--grpc-url` is obtained automatically from the Api when a user Sign In (issue the `hoop login` command)
</Note>

- Configure the Gateway URL, the gRPC URL and the TLS Certificate Root Certificate

```sh
hoop config create
  --api-url https://yourgateway-domain.tld \
  --tls-ca=file:///tmp/ca.pem

# inline configuration
hoop config create
  --api-url https://yourgateway-domain.tld \
  --tls-ca="base64://$(cat /tmp/ca.pem |base64)"
```

<Note>
  This option should be used if your gateway is running with self signed certificates.
</Note>

- Show `API_URL`, `GRPC_URL` and `TLS_CA` configuration

```sh
hoop config view
```

- Show all configuration with the access token (contains sensitive information)

```sh
hoop config view --raw
```

- Show sections of configuration

```sh
hoop config view api_url
hoop config view grpc_url
hoop config view token
hoop config view tls_ca
```

- Wipe Local Configuration

```bash
hoop config clear
```

## Interacting with Resources

The `hoop connect` command allows you to create an interactive session with a remote resource.
The resource include the interactive terminal console or native protocols.

### Terminal Console

- docker exec
- bash
- ssh
- rails console
- python console
- kubectl exec
- aws ecs execute-command

```bash
hoop connect bash-console
connection: bash-console | session: 53ed53f9-a5f9-45e9-bbf5-becd1f44f41e
root@5601881aa15e:/app#
```

### Terminal Ad Hoc Executions

Permit triggering ad hoc executions on a connection.

- Issue the command `env` to a connection with the `bash` as interpreter

```sh
hoop exec bash -i 'env'
```

- Run the script `/tmp/myscript.sh` using `bash` as the interpreter

```sh
hoop exec bash -f /tmp/myscript.sh
```

- Run the script `/tmp/myscript.sh` by reading it from the standard input using `bash` as interpreter

```sh
hoop exec bash <<EOF
env |grep -i 'id'
EOF
```

### Native Protocols

The connect feature can be used to interact with native protocols such as databases, SSH, HTTP and TCP.
The port is forwarded locally to the end-user, providing a secure connection to remote services.

```bash
$ hoop connect pg-prod
connection: pg-prod | session: 4619c80f-7166-487c-8c9f-9609e59ae5d6

--------------------postgres-credentials--------------------
      host=127.0.0.1 port=5433 user=noop password=noop
------------------------------------------------------------
ready to accept connections!
```

<Info>
  The connection is established through a secure tunnel by an encrypted channel when the gateway is setup with TLS.
  The user identity is always validated when interacting with such resources.
</Info>

