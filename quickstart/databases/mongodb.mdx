---
title: "MongoDB"
description: "A MongoDB connection is a native type, allowing for the auditing of queries and redaction of their output. It facilitates a local TCP connection without requiring a password."
category: "databases"
---

import { ConnectionTemplate } from '/snippets/connection-template.jsx';

<ConnectionTemplate config={{
  "id": "mongodb",
  "name": "MongoDB",
  "description": "A MongoDB connection is a native type, allowing for the auditing of queries and redaction of their output. It facilitates a local TCP connection without requiring a password.",
  "category": "databases",
  "icon-name": "mongodb",
  "tags": [
    "nosql",
    "document",
    "cloud"
  ],
  "isNew": false,
  "features": {
    "tlsTerminationProxy": {
      "native": true,
      "oneOff": true
    },
    "audit": {
      "native": true,
      "oneOff": true
    },
    "dataMaskingGoogleDLP": {
      "native": true,
      "oneOff": true
    },
    "dataMaskingMSPresidio": {
      "native": false,
      "oneOff": true
    },
    "credentialsOffload": {
      "native": true,
      "oneOff": true
    },
    "interactiveAccess": {
      "native": true,
      "oneOff": true
    }
  },
  "overview": {
    "description": "MongoDB is a NoSQL document-oriented database that provides high scalability and flexibility for modern applications.",
    "features": [
      "Flexible schema for rapid data evolution",
      "Horizontal scalability with automatic sharding",
      "Built-in replication for high availability",
      "Powerful queries with advanced indexing"
    ],
    "useCases": [
      "Web and mobile applications with variable data",
      "Content management systems",
      "E-commerce product catalogs",
      "Real-time data analytics"
    ]
  },
  "setupGuide": {
    "accessMethods": {
      "webapp": true,
      "cli": true,
      "runbooks": true
    },
    "requirements": [
      "MongoDB Server 4.0+",
      "User credentials with appropriate privileges",
      "Network connectivity to port 27017",
      "Proper firewall configuration"
    ]
  },
  "advancedConfiguration": {
    "connectionString": "mongodb://username:password@host:port/database",
    "featureConfiguration": [
      "Replica set configuration for high availability",
      "Sharding configuration for scalability",
      "Optimized indexes for frequent queries",
      "SSL/TLS configuration for secure connections"
    ],
    "otherRequirements": [
      "Performance monitoring enabled",
      "Automatic backup configured",
      "Storage capacity alerts"
    ]
  },
  "gatewayInformation": {
    "type": "database",
    "subtype": "mongodb",
    "credentials": {
      "connectionString": {
        "name": "CONNECTION_STRING",
        "type": "env-var",
        "required": true,
        "description": "The MongoDB connection string. See [MongoDB connection string](https://www.mongodb.com/docs/manual/reference/connection-string/) for more details about the proper format."
      }
    }
  },
  "documentationConfig": {
    "path": "quickstart/databases/mongodb"
  }
}} />
## Connection Setup

Create a new Database connection in hoop's web panel.

<Frame>
    <img src="/images/quickstarts/create-database-connection-screenshot.png" alt="create tcp connection screenshot" />
</Frame>

## Connection Usage

You can access it through hoop CLI or hoop web panel.

### Hoop CLI

```bash
hoop connect <connection-name>

connection: mongo | session: f2e7634a-f4c4-47cd-bee6-48da080e2a23

---------------------mongo-credentials----------------------
 mongodb://noop:noop@127.0.0.1:27018/?directConnection=true
------------------------------------------------------------
```

<Note>
Clients must use `noop` as both the username and password, along with the `directionConnection=true` option
</Note>

### Web panel

<Frame>
    <img src="/images/quickstarts/client-mongodb.png" alt="create tcp connection screenshot" />
</Frame>


## Known Issues

### Clients advertising the wrong server

The **native** implementation has a known issue in cluster setups where clients may incorrectly advertise connections to the wrong server.
Hoop selects a server at random and attempts to upgrade the connection to the primary server.
However, this transition is not properly propagated to clients, resulting in the advertisement of incorrect server information.

Users can manually switch to the primary server after connecting to a secondary server. For example, using `mongoshell`:

```sh
> db.getMongo().setReadPref('primary')
```

### Syntax Error Issues

The one-off execution uses the `mongo` legacy utility as a client to execute scripts.
Since input is provided through stdin, syntax errors may occur for more complex inputs.
To avoid these issues, use `mongosh` instead.

Add the comment in the beginning of the script to indicate that it should be executed with `mongosh`:

```sh
// mongosh
use sample_airbnb
db.listingsAndReviews.find({}, {_id: 1}).limit(10)
```

<Note>
    This feature is available in agent version `1.35.19` and later.
</Note>













